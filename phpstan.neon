includes:
    - vendor/larastan/larastan/extension.neon
    - vendor/nesbot/carbon/extension.neon

parameters:
    paths:
        - app/

    level: 8

    ignoreErrors:
        -
            message: '#^Trait App\\Traits\\HasBilling is used zero times and is not analysed\.$#'
            identifier: trait.unused
            count: 1
            path: app/Traits/HasBilling.php
        -
            message: '#^Trait App\\Traits\\TracksEmailDelivery is used zero times and is not analysed\.$#'
            identifier: trait.unused
            path: app/Traits/TracksEmailDelivery.php
        # Ignore generic type parameter requirements on scope methods - too verbose for minimal value
        -
            identifier: missingType.generics
            paths:
                - app/Models/Permission.php
                - app/Models/Role.php
                - app/Models/Scopes/*.php
        # Ignore missing iterable value types in PHPDoc - can be added incrementally
        -
            identifier: missingType.iterableValue
        # Ignore template type resolution issues in collections - Laravel framework level
        -
            identifier: argument.templateType
        # Searchable trait static property access - these are intentionally dynamic
        -
            message: '#Access to an undefined static property static\(.*\)::\$search(Permission|RouteName|Icon|Type)#'
            identifier: staticProperty.notFound
            path: app/Traits/Searchable.php
        # Searchable trait method calls - these are provided by models using the trait
        -
            message: '#Call to an undefined (static )?method .*::(performSearch|getSearchPermission|getSearchResultType|getSearchResultIcon|getShowRouteName)\(\)#'
            path: app/Services/SearchService.php
        # Spatie ActivityLog performedOn expects Model but receives contracts - library limitation
        -
            identifier: argument.type
            message: '#Parameter \#1 \$model of method Spatie\\Activitylog\\ActivityLogger::performedOn\(\) expects Illuminate\\Database\\Eloquent\\Model#'
        # Spatie Permission withCount method signature with variadic - Larastan/PHPStan limitation
        -
            identifier: arguments.count
            message: '#Method Illuminate\\Database\\Eloquent\\Builder.*::withCount\(\) invoked with 2 parameters#'
        # Enum instanceof checks in TaskService - values may come from request as strings
        -
            identifier: instanceof.alwaysFalse
            message: '#Instanceof between string(\|null)? and App\\Enums\\Modules\\Tasks\\(TaskType|TaskPriority) will always evaluate to false#'
            path: app/Services/TaskService.php
        # Nullsafe on non-nullable - model relationships loaded via load() may still be nullable
        -
            identifier: nullsafe.neverNull
        # Builder covariance issues with traits - PHPStan template limitation
        -
            identifier: return.type
            message: '#should return Illuminate\\Database\\Eloquent\\Builder<.*> but returns Illuminate\\Database\\Eloquent\\Builder<static\(.*\)>#'
        # Unused return types in controllers - design patterns
        -
            identifier: return.unusedType
        # Property only written warnings - event/notification data transfer
        -
            identifier: property.onlyWritten
        # BelongsToMany withInternal scope - dynamic scope via macro
        -
            identifier: method.notFound
            message: '#Call to an undefined method Illuminate\\Database\\Eloquent\\Relations\\BelongsToMany::withInternal#'
        # Object property access for polymorphic relations
        -
            identifier: property.notFound
            message: '#Access to an undefined property object::#'
        # FormRequest authorize() methods - can return null from Authenticatable
        -
            identifier: return.type
            message: '#Method App\\Http\\Requests\\.*::authorize\(\) should return bool but returns bool\|null#'
        # Array shape mismatch from validated() data - safe at runtime
        -
            identifier: argument.type
            message: '#Parameter \$data of method App\\Services\\TaskService::(createNewTask|updateTask)\(\) expects array#'
        # withoutGlobalScope $this reference in closures - valid Laravel pattern
        -
            identifier: argument.type
            message: '#Parameter \#1 \$scope of method.*::withoutGlobalScope\(\) expects#'
            paths:
                - app/Models/Scopes/*.php
        # User model permissions property generics - Spatie permission types
        -
            identifier: generics.notSubtype
            path: app/Models/User.php
        # BelongsToMany generics - too verbose for minimal value
        -
            identifier: missingType.generics
            path: app/Models/User.php
        # Carbon type variants - CarbonImmutable vs Carbon - functionally equivalent
        -
            identifier: return.type
            message: '#CarbonImmutable#'
        -
            identifier: assign.propertyType
            message: '#CarbonImmutable#'
        # Nullable ip/userAgent from request - checked at runtime
        -
            identifier: argument.type
            message: '#expects string, string\|null given#'
            path: app/Http/Responses/FortifyLoginResponse.php
        # Factory class paths - auto-discovered by Laravel
        -
            identifier: class.notFound
            message: '#Database\\Factories\\Models\\Modules#'
        -
            identifier: generics.notSubtype
            message: '#PHPDoc tag @use.*Factory#'
        # Scope parameter types - Laravel magic
        -
            identifier: missingType.parameter
            message: '#scopeOfType|scopeWithStatus|scopeSentBetween|scopeForRecipient|scopeForMailable#'
        # Role::findByName return type - model is compatible with contract
        -
            identifier: return.type
            path: app/Models/Role.php
        # Socialite redirect returns Symfony response - library behavior
        -
            identifier: return.type
            message: '#Method App\\Http\\Controllers\\Auth\\OAuthController::redirect\(\) should return#'
        # SearchService Searchable method calls - dynamic trait methods
        -
            identifier: method.notFound
            message: '#Call to an undefined method Illuminate\\Database\\Eloquent\\Model::(getSearchResultLabel|getSearchResultSubtitle)\(\)#'
            path: app/Services/SearchService.php
        # SearchService class-string return type - inherent limitation
        -
            identifier: return.type
            paths:
                - app/Services/SearchService.php
        # TaskService Collection generic type - too verbose to specify
        -
            identifier: missingType.generics
            path: app/Services/TaskService.php